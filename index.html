<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>منتجات - صفحة واحدة</title>
  <style>
    /* ======= تصميم عام (CSS داخلي) ======= */
    :root{
      --bg:#f6f8fa;
      --card:#ffffff;
      --accent:#25D366; /* لون واتساب */
      --muted:#6b7280;
      --shadow: 0 2px 8px rgba(15,23,42,0.06);
      --max-width:1100px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    html,body{height:100%;}
    body{
      margin:0;
      background:var(--bg);
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:24px 16px;
    }

    .container{
      width:100%;
      max-width:var(--max-width);
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:18px;
    }
    header h1{margin:0;font-size:1.2rem}
    header p{margin:0;color:var(--muted);font-size:0.95rem}

    /* رسائل الحالة */
    .status{
      background:linear-gradient(90deg,#fff,#fff);
      padding:12px 14px;
      border-radius:10px;
      box-shadow:var(--shadow);
      display:inline-block;
      color:var(--muted);
      margin-bottom:14px;
    }

    /* شبكة البطاقات */
    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap:16px;
    }

    .card{
      background:var(--card);
      border-radius:12px;
      overflow:hidden;
      box-shadow:var(--shadow);
      display:flex;
      flex-direction:column;
      transition:transform .15s ease, box-shadow .15s ease;
    }
    .card:hover{transform:translateY(-6px)}

    .card img{
      width:100%;
      height:170px;
      object-fit:cover;
      background:linear-gradient(90deg,#eee,#f7f7f7);
    }

    .card-body{
      padding:12px 14px;
      display:flex;
      flex-direction:column;
      gap:8px;
      flex:1 1 auto;
    }
    .product-name{font-weight:600;font-size:1rem}
    .product-desc{color:var(--muted);font-size:0.95rem}
    .price{margin-top:auto;font-weight:700;color:#111}

    .card-footer{
      padding:12px;
      display:flex;
      gap:8px;
      align-items:center;
      justify-content:space-between;
      border-top:1px solid #f0f0f0;
      background:linear-gradient(180deg, rgba(255,255,255,0), rgba(255,255,255,0));
    }

    .whatsapp-btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      background:var(--accent);
      color:white;
      padding:8px 12px;
      border-radius:8px;
      text-decoration:none;
      font-weight:600;
      box-shadow: 0 6px 18px rgba(37,211,102,0.12);
    }
    .whatsapp-btn:active{transform:translateY(1px)}

    /* زر بسيط لنسخ رابط المنتج (اختياري) */
    .copy-btn{
      background:transparent;
      border:1px solid #e6e6e6;
      padding:8px 10px;
      border-radius:8px;
      font-size:0.9rem;
      color:var(--muted);
      cursor:pointer;
    }

    /* تصميم متجاوب: عرض كامل على الشاشات الصغيرة */
    @media (max-width:520px){
      .card img{height:160px}
      body{padding:16px}
      header h1{font-size:1rem}
    }

  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>قائمة المنتجات</h1>
        <p>عرض سريع للمنتجات مع زر طلب عبر واتساب</p>
      </div>
      <div class="status" id="status">جارٍ تحميل المنتجات...</div>
    </header>

    <!-- هنا ستُضاف بطاقات المنتجات ديناميكياً -->
    <main>
      <div class="grid" id="productsGrid" aria-live="polite"></div>
    </main>
  </div>

  <script>
    // ======= إعدادات وقابلية التعديل =======
  // ضع هنا رابط ملف JSON الذي يحتوي على المنتجات (قابل للتعديل بسهولة)
  // تم تحديثه لاستخدام رابط المستخدم من GitHub Raw
  const PRODUCTS_JSON_URL = 'https://raw.githubusercontent.com/Rafeed2022/test/refs/heads/main/products-mock.json';

    // عناصر DOM المرجعية
    const statusEl = document.getElementById('status');
    const gridEl = document.getElementById('productsGrid');

    // دالة مساعدة لإنشاء عنصر بطاقة منتج واحد
    function createProductCard(product) {
      /*
        المتغير product يتوقع الهيكل التالي:
        {
          id, name, description, price, image, whatsapp
        }
      */

      // عنصر البطاقة الرئيسي
      const card = document.createElement('article');
      card.className = 'card';
      card.setAttribute('data-id', product.id);

      // صورة المنتج (مع تعويض افتراضي عند وجود خطأ في التحميل)
      const img = document.createElement('img');
      img.src = product.image || '';
      img.alt = product.name || 'صورة المنتج';
      img.loading = 'lazy';
      img.onerror = () => { img.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="600" height="400"><rect width="100%" height="100%" fill="#eee"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="#999" font-size="20">لا توجد صورة</text></svg>'; };

      // جسم البطاقة (اسم، وصف، سعر)
      const body = document.createElement('div');
      body.className = 'card-body';

      const name = document.createElement('div');
      name.className = 'product-name';
      name.textContent = product.name || 'اسم غير متوفر';

      const desc = document.createElement('div');
      desc.className = 'product-desc';
      desc.textContent = product.description || '';

      const price = document.createElement('div');
      price.className = 'price';
      price.textContent = product.price || '';

      body.appendChild(name);
      body.appendChild(desc);
      body.appendChild(price);

      // تذييل البطاقة مع زر واتساب وزر نسخ (اختياري)
      const footer = document.createElement('div');
      footer.className = 'card-footer';

      // زر واتساب: يفترض أن product.whatsapp يحتوي على رابط كامل (https://wa.me/...) مع رسالة مشفرة
      const waBtn = document.createElement('a');
      waBtn.className = 'whatsapp-btn';
      waBtn.href = product.whatsapp || '#';
      waBtn.target = '_blank';
      waBtn.rel = 'noopener noreferrer';
      waBtn.innerHTML = `<svg width=18 height=18 viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M20.5 3.5L3.5 20.5\" stroke=\"rgba(255,255,255,0.2)\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M16.7 7.3c1.2 1.2 1.9 2.8 1.9 4.6 0 3.9-3.2 7.1-7.1 7.1-1.8 0-3.4-0.7-4.6-1.9L3 21l2.9-3.9c-1.2-1.2-1.9-2.8-1.9-4.6 0-3.9 3.2-7.1 7.1-7.1 1.8 0 3.4 0.7 4.6 1.9z\" fill=\"white\"/></svg> اطلب عبر واتساب`;

      // حماية: إذا لم يتوفر رابط صحيح، نمنع الفتح ونظهر تنبيهًا بسيطًا
      if (!product.whatsapp) {
        waBtn.addEventListener('click', (e) => {
          e.preventDefault();
          alert('رابط واتساب غير متوفر لهذا المنتج.');
        });
      }

      // زر نسخ الرابط (اختياري، مفيد لمشاركة المنتج خارج التطبيق)
      const copyBtn = document.createElement('button');
      copyBtn.className = 'copy-btn';
      copyBtn.textContent = 'نسخ رابط المنتج';
      copyBtn.addEventListener('click', async () => {
        try {
          await navigator.clipboard.writeText(window.location.href + '#product-' + product.id);
          copyBtn.textContent = 'تم النسخ ✓';
          setTimeout(() => (copyBtn.textContent = 'نسخ رابط المنتج'), 1500);
        } catch (err) {
          alert('فشل النسخ');
        }
      });

      footer.appendChild(copyBtn);
      footer.appendChild(waBtn);

      card.appendChild(img);
      card.appendChild(body);
      card.appendChild(footer);

      return card;
    }

    // دالة لجلب بيانات JSON ثم عرضها
    async function loadAndRenderProducts(url) {
      statusEl.textContent = 'جارٍ تحميل المنتجات...';
      gridEl.innerHTML = '';

      try {
        const resp = await fetch(url, {cache: 'no-cache'});
        if (!resp.ok) throw new Error('HTTP ' + resp.status);
        const data = await resp.json();

        if (!Array.isArray(data) || data.length === 0) {
          statusEl.textContent = 'لا توجد منتجات للعرض.';
          return;
        }

        // إنشاء كل بطاقة وإلحاقها بالشبكة
        data.forEach(item => {
          const card = createProductCard(item);
          gridEl.appendChild(card);
        });

        statusEl.textContent = `تم تحميل ${data.length} منتجاً`;
      } catch (err) {
        console.error('خطأ عند جلب المنتجات:', err);
        statusEl.textContent = 'فشل تحميل المنتجات. تحقق من رابط JSON أو الشبكة.';
      }
    }

    // نفذ عند تحميل الصفحة: استبدل الرابط الافتراضي قبل الاستخدام
    
    document.addEventListener('DOMContentLoaded', () => {
      // تذكير: عدّل قيمة PRODUCTS_JSON_URL في أعلى الملف إلى رابطك الحقيقي
      
      loadAndRenderProducts(PRODUCTS_JSON_URL);
    });

  </script>
</body>
</html>